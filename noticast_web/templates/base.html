<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <script src="{{ url_for('static', filename='node_modules/jquery/dist/jquery.min.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='node_modules/bulma/css/bulma.min.css') }}">
    <title>NotiCast</title>
    <style>
    ul {
      list-style: disc inside;
    }
    ol {
      list-style-position: inside;
    }
    section.notifications {
      padding-top: 3.5rem;
    }
    </style>
  </head>
  <body>
    <nav class="navbar has-background-white-ter" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
{% if session.client_id %}
        <a class="navbar-item" href="/">NotiCast // {{ g.user.username }}</a>
{% else %}
        <a class="navbar-item" href="/">NotiCast</a>
{% endif %}
      </div>
      <div class="navbar-menu">
        <a class="navbar-item" href="{{ url_for('auth.login') }}">Log In</a>
        <a class="navbar-item" href="{{ url_for('auth.register') }}">Register</a>
{% if session.client_id %}
        <a class="navbar-item" href="{{ url_for('device.register') }}">Add Device</a>
        <a class="navbar-item" href="{{ url_for('group.index') }}">Manage Groups</a>
        <div class="navbar-end">
          <a class="navbar-item"
             href="{{ url_for('auth.logout') }}">Log Out</a>
        </div>
{% endif %}
      </div>
      <script charset="utf-8">
        $("nav.navbar a").each(function() {
          if ($(this).attr("href") == window.location.pathname)
            $(this).addClass("is-active");
        });
      </script>
    </nav>
{% with messages = get_flashed_messages(category_filter=["notification"]) %}
{% if messages %}
    <section class="notifications">
      <div class="container">
{% for message in messages %}
{% set message_values = message.split("|") %}
        <div class="notification is-{{ message_values[1] }}">
          <button class="delete"></button>
          {{ message_values[0] }}
        </div>
{% endfor %}
      </div>
    </section>
{% endif %}
{% endwith %}
    <script charset="utf-8">
      let elem = $("button.delete");
      let count = elem.length;
      elem.click(function() {
        $(this).parent("div.notification").remove();
        if (--count == 0) {
          $("section.notifications").remove();
        }
      });
    </script>
    <section class="section">
      <div class="container">
        {% block body %}{% endblock %}
      </div>
    </section>
    {% block script %}{% endblock %}
  </body>
</html>
